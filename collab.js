const studentData = [
    {
      "info": {
        "name": "이헌성",
        "number": "21011898"
      },
      "schedule": [
        {
          "class_name": "신시",
          "class_days": [1, 3, 5],
          "start_time": "10:30",
          "end_time": "12:00",
          "location": "센B204"
        },
        {
          "class_name": "창기정",
          "class_days": [3],
          "start_time": "13:30",
          "end_time": "15:00",
          "location": "동천관418"
        },
        {
          "class_name": "erp",
          "class_days": [4],
          "start_time": "13:30",
          "end_time": "15:00",
          "location": "동천관418"
        },
        {
          "class_name": "확통",
          "class_days": [1, 3],
          "start_time": "16:30",
          "end_time": "18:00",
          "location": "동천관418"
        },
        {
          "class_name": "알고리즘",
          "class_days": [5],
          "start_time": "13:00",
          "end_time": "15:00",
          "location": "동천관418"
        },
        {
          "class_name": "동시모",
          "class_days": [2, 4],
          "start_time": "16:30",
          "end_time": "18:00",
          "location": "동천관418"
        },
        {
          "class_name": "ml",
          "class_days": [2],
          "start_time": "19:00",
          "end_time": "21:00",
          "location": "동천관418"
        }
      ]
    },
    {
      "info": {
        "name": "김태경",
        "number": "23011927"
      },
      "schedule": [
        {
          "class_name": "선형대수및프로그래밍",
          "class_days": [1, 3],
          "start_time": "10:30",
          "end_time": "12:00",
          "location": "센B204"
        },
        {
          "class_name": "창호강",
          "class_days": [4],
          "start_time": "16:30",
          "end_time": "18:00",
          "location": "동천관418"
        },
        {
          "class_name": "비전공조교",
          "class_days": [1],
          "start_time": "12:00",
          "end_time": "13:30",
          "location": "동천관418"
        },
        {
          "class_name": "전공조교",
          "class_days": [2],
          "start_time": "16:00",
          "end_time": "18:00",
          "location": "동천관418"
        },
        {
          "class_name": "신시",
          "class_days": [3],
          "start_time": "18:00",
          "end_time": "21:00",
          "location": "동천관418"
        },
        {
          "class_name": "웹프",
          "class_days": [4],
          "start_time": "18:00",
          "end_time": "21:00",
          "location": "동천관418"
        },
        {
          "class_name": "ml",
          "class_days": [2],
          "start_time": "19:00",
          "end_time": "21:00",
          "location": "동천관418"
        },
        {
          "class_name": "알고리즘",
          "class_days": [4],
          "start_time": "13:30",
          "end_time": "15:30",
          "location": "동천관418"
        },
        {
          "class_name": "금공강",
          "class_days": [5],
          "start_time": "09:00",
          "end_time": "24:00",
          "location": "동천관418"
        }
      ]
    },
    {
        "info": {
          "name": "권효정",
          "number": "22011925"
        },
        "schedule": [
          {
            "class_name": "사물인터넷",
            "class_days": [1, 3],
            "start_time": "16:30",
            "end_time": "18:00",
            "location": "센B204"
          },
          {
            "class_name": "인공지능",
            "class_days": [2, 4],
            "start_time": "13:30",
            "end_time": "15:00",
            "location": "동천관418"
          },
          {
            "class_name": "중국문화의이해",
            "class_days": [2, 4],
            "start_time": "12:00",
            "end_time": "13:30",
            "location": "동천관418"
          },
          {
            "class_name": "로보틱스",
            "class_days": [1, 3],
            "start_time": "10:30",
            "end_time": "12:00",
            "location": "동천관418"
          },
          {
            "class_name": "랩미팅",
            "class_days": [1],
            "start_time": "12:30",
            "end_time": "13:30",
            "location": "동천관418"
          },
          {
            "class_name": "사물인터넷스터디",
            "class_days": [1],
            "start_time": "13:30",
            "end_time": "15:00",
            "location": "동천관418"
          },
          {
            "class_name": "nlp",
            "class_days": [1, 2],
            "start_time": "16:30",
            "end_time": "18:00",
            "location": "동천관418"
          },
          {
            "class_name": "연구실",
            "class_days": [3],
            "start_time": "13:30",
            "end_time": "16:30",
            "location": "동천관418"
          },
          {
            "class_name": "프로젝트",
            "class_days": [3],
            "start_time": "18:00",
            "end_time": "21:00",
            "location": "동천관418"
          },
          {
            "class_name": "임베디드",
            "class_days": [5],
            "start_time": "12:00",
            "end_time": "15:00",
            "location": "동천관418"
          },
          {
            "class_name": "sw코딩",
            "class_days": [5],
            "start_time": "15:00",
            "end_time": "16:30",
            "location": "동천관418"
          },
          {
            "class_name": "인공지능",
            "class_days": [2, 4],
            "start_time": "20:00",
            "end_time": "21:00",
            "location": "동천관418"
          }
        ]
      },
      {
        "info": {
          "name": "김하연",
          "number": "23011881"
        },
        "schedule": [
          {
            "class_name": "근로 오전",
            "class_days": [1, 2, 3],
            "start_time": "09:00",
            "end_time": "13:00",
            "location": "센B204"
          },
          {
            "class_name": "신시",
            "class_days": [1, 3],
            "start_time": "13:30",
            "end_time": "15:00",
            "location": "동천관418"
          },
          {
            "class_name": "ml",
            "class_days": [2],
            "start_time": "19:00",
            "end_time": "21:00",
            "location": "동천관418"
          },
          {
            "class_name": "알고리즘",
            "class_days": [2],
            "start_time": "13:30",
            "end_time": "15:30",
            "location": "동천관418"
          },
          {
            "class_name": "확통",
            "class_days": [1, 3],
            "start_time": "16:30",
            "end_time": "18:00",
            "location": "동천관418"
          },
          {
            "class_name": "데분스",
            "class_days": [1],
            "start_time": "19:00",
            "end_time": "21:00",
            "location": "동천관418"
          },
          {
            "class_name": "공수",
            "class_days": [2, 4],
            "start_time": "16:30",
            "end_time": "18:00",
            "location": "동천관418"
          },
          {
            "class_name": "동서양",
            "class_days": [2],
            "start_time": "18:00",
            "end_time": "19:00",
            "location": "동천관418"
          },
          {
            "class_name": "목 근로",
            "class_days": [4],
            "start_time": "11:00",
            "end_time": "14:00",
            "location": "동천관418"
          },
          {
            "class_name": "금 근로",
            "class_days": [5],
            "start_time": "11:00",
            "end_time": "17:00",
            "location": "동천관418"
          },
          {
            "class_name": "웹프",
            "class_days": [4],
            "start_time": "18:00",
            "end_time": "21:00",
            "location": "동천관418"
          }
        ]
      }
  ]
    
    function parseTime(timeStr) {
      const [hours, minutes] = timeStr.split(':').map(Number);
      return hours * 60 + minutes;
    }
    
    function getFreeTimeForStudent(schedule) {
      const freeTimes = Array(5).fill(null).map(() => Array(30).fill(true));
      
      schedule.forEach(({ class_days, start_time, end_time }) => {
        const startTime = parseTime(start_time);
        const endTime = parseTime(end_time);
        class_days.forEach(day => {
          for (let time = startTime; time < endTime; time += 30) {
            const timeSlot = (time - 540) / 30; // Adjusted for 9:00 (540 minutes) start
            if (timeSlot >= 0 && timeSlot < 30) {
              freeTimes[day - 1][timeSlot] = false;
            }
          }
        });
      });
      return freeTimes;
    }
    
    function findCommonFreeTime() {
      const inputNames = document.getElementById('student-names').value.split(',').map(name => name.trim());
      const selectedStudents = studentData.filter(student => inputNames.includes(student.info.name));
    
      if (selectedStudents.length === 0) {
        alert("일치하는 학생이 없습니다.");
        return;
      }
    
      let commonFreeTimes = Array(5).fill(null).map(() => Array(30).fill(true));
    
      selectedStudents.forEach(student => {
        const studentFreeTimes = getFreeTimeForStudent(student.schedule);
        commonFreeTimes = commonFreeTimes.map((day, dayIndex) => 
          day.map((time, timeIndex) => time && studentFreeTimes[dayIndex][timeIndex])
        );
      });
    
      displayScheduleTable(commonFreeTimes);
    }
    
    function displayScheduleTable(freeTimes) {
      const container = document.getElementById('schedule-table-container');
      container.innerHTML = '';  // Clear previous content
    
      const table = document.createElement('table');
      const headerRow = document.createElement('tr');
      
      // Header Row with Days
      const days = ["월요일", "화요일", "수요일", "목요일", "금요일"];
      headerRow.appendChild(document.createElement('th')); // Empty cell for time labels
      days.forEach(day => {
        const th = document.createElement('th');
        th.textContent = day;
        headerRow.appendChild(th);
      });
      table.appendChild(headerRow);
    
      // Create rows for each 30-minute time slot from 9:00 to 24:00
      for (let minutes = 540; minutes < 1440; minutes += 30) { // 540 = 9:00, 1440 = 24:00
        const row = document.createElement('tr');
        const timeCell = document.createElement('th');
        const hour = Math.floor(minutes / 60);
        const minute = minutes % 60;
        timeCell.textContent = `${hour.toString().padStart(2, '0')}:${minute.toString().padStart(2, '0')}`;
        row.appendChild(timeCell);
    
        freeTimes.forEach(day => {
          const timeSlot = (minutes - 540) / 30;
          const cell = document.createElement('td');
          cell.className = day[timeSlot] ? 'free' : 'busy';
          cell.textContent = day[timeSlot] ? 'O' : 'X';
          row.appendChild(cell);
        });
        table.appendChild(row);
      }
    
      container.appendChild(table);
    }
    